

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Photosphere &mdash; xpsi 0.2.0-alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "math|output_area", "processEscapes": true, "ignoreClass": "document", "inlineMath": [["$", "$"], ["\\(", "\\)"]]}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="HotRegion" href="hotregion.html" />
    <link rel="prev" title="Spacetime" href="spacetime.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> xpsi
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">(FA)Q</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="SURFsara_systems.html">SURFsara systems</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="model_construction.html">Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_script.html">Example script and modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_job.html">Example job</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">Extension modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Likelihood API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="parameterSpace.html">ParameterSpace</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameterSubspace.html">ParameterSubspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="likelihood.html">Likelihood</a></li>
<li class="toctree-l1"><a class="reference internal" href="pulse.html">Pulse</a></li>
<li class="toctree-l1"><a class="reference internal" href="instrument.html">Instrument</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="star.html">Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="spacetime.html">Spacetime</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Photosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="hotregion.html">HotRegion</a></li>
<li class="toctree-l1"><a class="reference internal" href="twohotregions.html">TwoHotRegions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hotregions.html">HotRegions</a></li>
<li class="toctree-l1"><a class="reference internal" href="elsewhere.html">Elsewhere</a></li>
<li class="toctree-l1"><a class="reference internal" href="interstellar.html">Interstellar</a></li>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background</a></li>
</ul>
<p class="caption"><span class="caption-text">Posterior API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prior.html">Prior</a></li>
<li class="toctree-l1"><a class="reference internal" href="posterior.html">Posterior</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample.html">Sample</a></li>
<li class="toctree-l1"><a class="reference internal" href="postprocessing.html">PostProcessing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">xpsi</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Photosphere</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/photosphere.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<span class="target" id="module-xpsi.Photosphere"></span><div class="section" id="photosphere">
<span id="id1"></span><h1>Photosphere<a class="headerlink" href="#photosphere" title="Permalink to this headline">¶</a></h1>
<p>Instances of <a class="reference internal" href="#xpsi.Photosphere.Photosphere" title="xpsi.Photosphere.Photosphere"><code class="xref py py-class docutils literal notranslate"><span class="pre">Photosphere</span></code></a> represent a photosphere embedded
in an ambient Schwarzschild spacetime.</p>
<dl class="class">
<dt id="xpsi.Photosphere.Photosphere">
<em class="property">class </em><code class="descclassname">xpsi.Photosphere.</code><code class="descname">Photosphere</code><span class="sig-paren">(</span><em>tag</em>, <em>hot</em>, <em>elsewhere=None</em>, <em>locked=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/xpsi/Photosphere.html#Photosphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xpsi.Photosphere.Photosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="parameterSubspace.html#xpsi.ParameterSubspace.ParameterSubspace" title="xpsi.ParameterSubspace.ParameterSubspace"><code class="xref py py-class docutils literal notranslate"><span class="pre">xpsi.ParameterSubspace.ParameterSubspace</span></code></a></p>
<p>A photosphere embedded in an ambient Schwarzschild spacetime.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tag</strong> (<em>str</em>) – An identification tag to enforce intended pairing with
a <a class="reference internal" href="pulse.html#xpsi.Pulse.Pulse" title="xpsi.Pulse.Pulse"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pulse</span></code></a> object.</li>
<li><strong>hot</strong> (<em>obj</em>) – An instance of <a class="reference internal" href="hotregion.html#xpsi.HotRegion.HotRegion" title="xpsi.HotRegion.HotRegion"><code class="xref py py-class docutils literal notranslate"><span class="pre">HotRegion</span></code></a> (or a
derived class). This objects represents the hot
regions of the surface that in most use-cases will be
assumed to contain radiating material that is hotter
than that <em>elsewhere</em>.</li>
<li><strong>elsewhere</strong> (<em>obj</em>) – An instance of <a class="reference internal" href="elsewhere.html#xpsi.Elsewhere.Elsewhere" title="xpsi.Elsewhere.Elsewhere"><code class="xref py py-class docutils literal notranslate"><span class="pre">Elsewhere</span></code></a>
(or a derived class).</li>
<li><strong>locked</strong> (<em>bool</em>) – Has no effect. However, if one wanted the coordinate rotation
frequency of a mode of asymmetry in the photosphere to <em>not be
locked</em> to the stellar rotation frequency, a parameter could
be defined for this object and the hot region base class could
be modified to normalise the ray lags by this frequency instead
of the stellar rotation frequency.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="xpsi.Photosphere.Photosphere.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#xpsi.Photosphere.Photosphere.bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of tuples of hard parameter bounds.</p>
</dd></dl>

<dl class="attribute">
<dt id="xpsi.Photosphere.Photosphere.elsewhere_atmosphere">
<code class="descname">elsewhere_atmosphere</code><a class="headerlink" href="#xpsi.Photosphere.Photosphere.elsewhere_atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the numerical atmosphere buffers for elsewhere if used.</p>
<p>To preload a numerical atmosphere into a buffer, subclass and
overwrite the setter. The underscore attribute set by the setter
must be an <span class="math notranslate nohighlight">\(n\)</span>-tuple whose <span class="math notranslate nohighlight">\(n^{th}\)</span> element is an
<span class="math notranslate nohighlight">\((n-1)\)</span>-dimensional array flattened into a one-dimensional
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>. The first <span class="math notranslate nohighlight">\(n-1\)</span>
elements of the <span class="math notranslate nohighlight">\(n\)</span>-tuple must each be an ordered one-dimensional
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of parameter values for the purpose of
multi-dimensional interpolation in the <span class="math notranslate nohighlight">\(n^{th}\)</span> buffer. The
first <span class="math notranslate nohighlight">\(n-1\)</span> elements must be ordered to match the index
arithmetic applied to the <span class="math notranslate nohighlight">\(n^{th}\)</span> buffer. An example would be
<code class="docutils literal notranslate"><span class="pre">self._hot_atmosphere</span> <span class="pre">=</span> <span class="pre">(logT,</span> <span class="pre">logg,</span> <span class="pre">mu,</span> <span class="pre">logE,</span> <span class="pre">buf)</span></code>, where:
<code class="docutils literal notranslate"><span class="pre">logT</span></code> is a logarithm of local comoving effective temperature;
<code class="docutils literal notranslate"><span class="pre">logg</span></code> is a logarithm of effective surface gravity;
<code class="docutils literal notranslate"><span class="pre">mu</span></code> is the cosine of the angle from the local surface normal;
<code class="docutils literal notranslate"><span class="pre">logE</span></code> is a logarithm of the photon energy; and
<code class="docutils literal notranslate"><span class="pre">buf</span></code> is a one-dimensional buffer of intensities of size given by
the product of sizes of the first <span class="math notranslate nohighlight">\(n-1\)</span> tuple elements.</p>
<p>It is highly recommended that buffer preloading is used, instead
of loading from disk in the customisable radiation field extension
module, to avoid reading from disk for every signal
(likelihood) evaluation. This can be a non-negligible waste of compute
resources. By preloading in Python, the memory is allocated and
references to that memory are not in general deleted until a sampling
script exits and the kernel stops. The likelihood callback accesses
the same memory upon each call without I/O.</p>
</dd></dl>

<dl class="method">
<dt id="xpsi.Photosphere.Photosphere.embed">
<code class="descname">embed</code><span class="sig-paren">(</span><em>spacetime</em>, <em>p</em>, <em>fast_total_counts</em>, <em>threads</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/xpsi/Photosphere.html#Photosphere.embed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xpsi.Photosphere.Photosphere.embed" title="Permalink to this definition">¶</a></dt>
<dd><p>Embed the photosphere in an ambient Schwarzschild spacetime.</p>
<p>In other words, generate a discrete representation of the photospheric
radiation field and the null mapping from the photosphere to infinity,
for use in flux integrators called by distant observers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>spacetime</strong> (<em>obj</em>) – Instance of <a class="reference internal" href="spacetime.html#xpsi.Spacetime.Spacetime" title="xpsi.Spacetime.Spacetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spacetime</span></code></a>.</li>
<li><strong>p</strong> (<em>list</em>) – Parameters of photospheric radiation field.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Parameter vector:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">p[i]</span></code> = coordinate mode/oscillation frequency, <em>if not locked</em></li>
<li><code class="docutils literal notranslate"><span class="pre">p[i:j]</span></code> = parameters for photospheric hot region(s)</li>
<li><code class="docutils literal notranslate"><span class="pre">p[j:]</span></code> = parameters for radiation field elsewhere</li>
</ul>
<p>where <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">self._num_params</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">self._hot.num_params</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="xpsi.Photosphere.Photosphere.hot_atmosphere">
<code class="descname">hot_atmosphere</code><a class="headerlink" href="#xpsi.Photosphere.Photosphere.hot_atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the numerical atmosphere buffers for hot regions if used.</p>
<p>To preload a numerical atmosphere into a buffer, subclass and
overwrite the setter. The underscore attribute set by the setter
must be an <span class="math notranslate nohighlight">\(n\)</span>-tuple whose <span class="math notranslate nohighlight">\(n^{th}\)</span> element is an
<span class="math notranslate nohighlight">\((n-1)\)</span>-dimensional array flattened into a one-dimensional
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>. The first <span class="math notranslate nohighlight">\(n-1\)</span>
elements of the <span class="math notranslate nohighlight">\(n\)</span>-tuple must each be an ordered one-dimensional
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of parameter values for the purpose of
multi-dimensional interpolation in the <span class="math notranslate nohighlight">\(n^{th}\)</span> buffer. The
first <span class="math notranslate nohighlight">\(n-1\)</span> elements must be ordered to match the index
arithmetic applied to the <span class="math notranslate nohighlight">\(n^{th}\)</span> buffer. An example would be
<code class="docutils literal notranslate"><span class="pre">self._hot_atmosphere</span> <span class="pre">=</span> <span class="pre">(logT,</span> <span class="pre">logg,</span> <span class="pre">mu,</span> <span class="pre">logE,</span> <span class="pre">buf)</span></code>, where:
<code class="docutils literal notranslate"><span class="pre">logT</span></code> is a logarithm of local comoving effective temperature;
<code class="docutils literal notranslate"><span class="pre">logg</span></code> is a logarithm of effective surface gravity;
<code class="docutils literal notranslate"><span class="pre">mu</span></code> is the cosine of the angle from the local surface normal;
<code class="docutils literal notranslate"><span class="pre">logE</span></code> is a logarithm of the photon energy; and
<code class="docutils literal notranslate"><span class="pre">buf</span></code> is a one-dimensional buffer of intensities of size given by
the product of sizes of the first <span class="math notranslate nohighlight">\(n-1\)</span> tuple elements.</p>
<p>It is highly recommended that buffer preloading is used, instead
of loading from disk in the customisable radiation field extension
module, to avoid reading from disk for every signal
(likelihood) evaluation. This can be a non-negligible waste of compute
resources. By preloading in Python, the memory is allocated and
references to that memory are not in general deleted until a sampling
script exits and the kernel stops. The likelihood callback accesses
the same memory upon each call without I/O.</p>
</dd></dl>

<dl class="method">
<dt id="xpsi.Photosphere.Photosphere.integrate">
<code class="descname">integrate</code><span class="sig-paren">(</span><em>energies</em>, <em>threads</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/xpsi/Photosphere.html#Photosphere.integrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xpsi.Photosphere.Photosphere.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate over the photospheric radiation field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>energies</strong> – A one-dimensional <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of energies
in keV.</li>
<li><strong>threads</strong> (<em>int</em>) – Number of <code class="docutils literal notranslate"><span class="pre">OpenMP</span></code> threads to spawn for pulse
integration.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="xpsi.Photosphere.Photosphere.num_params">
<code class="descname">num_params</code><a class="headerlink" href="#xpsi.Photosphere.Photosphere.num_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dimensions of the parameter subspace.</p>
</dd></dl>

<dl class="attribute">
<dt id="xpsi.Photosphere.Photosphere.pulse">
<code class="descname">pulse</code><a class="headerlink" href="#xpsi.Photosphere.Photosphere.pulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the stored pulse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of size <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">n</span></code>, where <code class="docutils literal notranslate"><span class="pre">m</span></code> is
the number of energies, and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of phases.
Units are photon/s/keV; the distance is a fast parameter so
the area units are not yet factored in.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="xpsi.Photosphere.Photosphere.tag">
<code class="descname">tag</code><a class="headerlink" href="#xpsi.Photosphere.Photosphere.tag" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ID tag of the photosphere object for pulse pairing.</p>
</dd></dl>

<dl class="attribute">
<dt id="xpsi.Photosphere.Photosphere.total_params">
<code class="descname">total_params</code><a class="headerlink" href="#xpsi.Photosphere.Photosphere.total_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the total number of photospheric radiation field parameters.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hotregion.html" class="btn btn-neutral float-right" title="HotRegion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spacetime.html" class="btn btn-neutral float-left" title="Spacetime" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Thomas E. Riley

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>